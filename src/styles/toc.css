#table-of-contents #toc-heading {
  /* base glass effect even when closed (slightly subtler) */
  display: inline-block;
  padding: 0.3rem 0.65rem;
  border-radius: 0.65rem;
  background: rgba(255, 255, 255, 0.25);
  border: 1px solid rgba(255, 255, 255, 0.35);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.35), 0 4px 12px rgba(0, 0, 0, 0.06);
  backdrop-filter: blur(6px) saturate(130%);
  transition: background 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}

#table-of-contents #toc-heading:hover {
  background: rgba(255, 255, 255, 0.32);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.45), 0 6px 16px rgba(0, 0, 0, 0.09);
}

/* Table of Contents Styles */
#table-of-contents a {
  display: block;
  padding: 0.125rem 0.25rem;
  border-radius: 0.375rem;
  outline: none;
}

#table-of-contents a:focus-visible {
  outline: 2px solid #2563eb;
  outline-offset: 2px;
  background-color: rgba(37, 99, 235, 0.08);
  color: #1f2937;
}

.toc-bedazzled {
  position: relative;
  overflow: hidden;
  background: url("data:image/svg+xml;utf8,<svg width='40' height='40' viewBox='0 0 40 40' fill='none' xmlns='http://www.w3.org/2000/svg'><circle cx='20' cy='20' r='1.5' fill='%23a5b4fc' opacity='0.4'/><circle cx='10' cy='30' r='1' fill='%23f472b6' opacity='0.3'/><circle cx='30' cy='10' r='1' fill='%23fbbf24' opacity='0.3'/></svg>"),
    linear-gradient(135deg, rgba(228, 219, 219, 0.95) 65%, rgba(154, 164, 170, 0.85) 100%);
  background-blend-mode: overlay;
  border-radius: 1rem;
  border: 2px solid #a5b4fc;
  box-shadow: 0 8px 24px 0 rgba(59, 130, 246, 0.09);
  padding: 2rem 1.5rem;
  transition: box-shadow 0.2s;
}

.toc-bedazzled h2 {
  color: #6366f1;
  letter-spacing: 0.03em;
}

.toc-bedazzled ul {
  background: transparent;
  list-style: none;
  padding-left: 0;
}

.toc-bedazzled a {
  background: rgba(255, 255, 255, 0.4);
  border-radius: 0.5rem;
  padding: 0.2rem 0.6rem;
  transform: translateX(-4px);
  font-size: clamp(0.85em, 3.5vw + 0.1em, 1em);
  font-weight: clamp(400, 10vw + 400, 700);
  transition: color 0.2s, transform 0.2s, background-color 0.2s;
  color: #4b5563;
  text-decoration: none;
}

.toc-bedazzled a:hover {
  transform: translateX(4px);
  background-color: #4f46e5;
  color: #ffffff;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.toc-bedazzled a.active {
  background: #717ec3;
  color: #1A202C;
  font-weight: bold;
}

/* TOC transition styles (all screen sizes) */
#table-of-contents .toc-body {
  overflow: hidden;
  will-change: max-height, opacity, transform;
}

.toc-slide-enter-active,
.toc-slide-leave-active {
  transition:
    max-height 0.55s ease-in-out,
    opacity 0.5s ease-in-out,
    transform 0.5s ease-in-out;
}

.toc-slide-enter-from,
.toc-slide-leave-to {
  max-height: 0;
  opacity: 0;
  transform: translateY(-6px);
}

.toc-slide-enter-to,
.toc-slide-leave-from {
  max-height: 1000px; /* large enough to cover typical TOC content */
  opacity: 1;
  transform: translateY(0);
}

/* (removed top glass highlight for container) */

.toc-bedazzled::after {
  content: "";
  position: absolute;
  bottom: 0.5rem;
  right: 0.5rem;
  width: 20rem;
  height: 20rem;
  opacity: 0.4;
  pointer-events: none;
  z-index: 1;
  background: url("data:image/svg+xml;utf8,<svg width='320' height='320' viewBox='0 0 64 64' fill='none' xmlns='http://www.w3.org/2000/svg'><rect x='0' y='0' width='32' height='32' fill='%236366f1' fill-opacity='0.6'/><rect x='32' y='32' width='32' height='32' fill='%23fbbf24' fill-opacity='0.5'/><circle cx='48' cy='16' r='10' fill='%23f472b6' fill-opacity='0.3'/><rect x='16' y='48' width='16' height='8' fill='%233b82f6' fill-opacity='0.4'/></svg>") no-repeat center/contain;
}

/* Emphasize heading and items when TOC is expanded */
#table-of-contents.toc-open #toc-heading {
  /* Glassmorphic pill for the title when open */
  display: inline-block;
  padding: 0.35rem 0.75rem;
  border-radius: 0.75rem;
  background: rgba(255, 255, 255, 0.35);
  border: 1px solid rgba(255, 255, 255, 0.45);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 6px 16px rgba(0, 0, 0, 0.08);
  backdrop-filter: blur(8px) saturate(140%);
  color: #0f172a; /* readable text */
  letter-spacing: 0.01em;
  font-weight: 750;
  font-size: 1.125rem; /* ~text-xl */
  transition: background 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
}

#table-of-contents.toc-open .toc-body a {
  color: #0f172a; /* slate-950-ish for readability */
  font-weight: 650;
}

#table-of-contents.toc-open .toc-body a:hover {
  background-color: rgba(37, 99, 235, 0.95); /* indigo-600/700 */
  color: #ffffff;
  transform: translateX(6px);
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25);
}

/* Emphasize container when open */
#table-of-contents.toc-open.toc-bedazzled {
  border-color: rgba(255, 255, 255, 0.55);
  box-shadow:
    0 14px 36px rgba(0, 0, 0, 0.12),
    inset 0 1px 0 rgba(255, 255, 255, 0.55);
  backdrop-filter: blur(14px) saturate(160%);
}

/* Dark mode overrides (kept together at the end for clear structure) */
@media (prefers-color-scheme: dark) {
  /* Heading pill base (closed or open) */
  #table-of-contents #toc-heading {
    background: rgba(17, 24, 39, 0.35);
    border-color: rgba(255, 255, 255, 0.12);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.08), 0 4px 12px rgba(0, 0, 0, 0.35);
    color: #e5e7eb;
    backdrop-filter: blur(8px) saturate(140%);
  }

  /* Hover on heading pill */
  #table-of-contents #toc-heading:hover {
    background: rgba(17, 24, 39, 0.42);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.12), 0 6px 16px rgba(0, 0, 0, 0.45);
  }

  /* Open-state heading pill in dark mode overrides general open-state */
  #table-of-contents.toc-open #toc-heading {
    background: rgba(30, 41, 59, 0.45);
    border-color: rgba(255, 255, 255, 0.18);
    color: #f3f4f6;
  }

  #table-of-contents a:focus-visible {
    outline-color: #60a5fa;
    background-color: rgba(96, 165, 250, 0.15);
    color: #f9fafb;
  }

  .toc-bedazzled {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.68) 0%, rgba(30, 41, 59, 0.56) 100%);
    border-color: rgba(99, 102, 241, 0.3);
  }
  .toc-bedazzled a {
    color: #e5e7eb;
    background: rgba(17, 24, 39, 0.4);
  }

  .toc-bedazzled a:hover {
    background-color: #4338ca;
    color: #ffffff;
  }
}
